<!DOCTYPE html>
<html lang="pt-BR" style="background-color: rgb(102, 174, 102);">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário</title>
    <link rel="stylesheet" type="text/css" href="./styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <form>
        <div class="wide-container" style="background-color:rgb(102, 174, 102); margin-top: 15px;">
            <div class="row" style="margin-left: 1vw; margin-right: 1vw; ">
                <div class="col-md-6">
                    <div class="row" style="margin-left: 20px; margin-right: 20px; justify-content: center;">
                        <h1 style="text-align: center; font-size: 4vh; margin-bottom: 15px;">CADASTRAMENTO LEGAL</h1>
                        <div class="col-md-6" style="display: grid;">
                            <img src="./logo.png" alt="Exemplo de imagem"><br>
                            <img src="./cidadeRes.jpeg" alt="Exemplo de imagem" style="height: 80%;"><br>

                            <label for="nomeEmpresa">Nome da Empresa:</label>
                            <input type="text" id="nomeEmpresa" name="nomeEmpresa" required><br><br>

                            <!-- CNPJ -->
                            <label for="cnpj">CNPJ:</label>
                            <input type="text" id="cnpj" name="cnpj" required><br><br>

                            <!-- Filial ou Sede -->
                            <label for="filialSede">Filial ou Sede:</label>
                            <input type="text" id="filialSede" name="filialSede" required><br><br>

                        </div>
                        <div class="col-md-6">
                            <!-- Lista de Atividades (Fornecimentos) -->
                            <label for="listaAtividades">Lista de Atividades (Fornecimentos) que se propõe a realizar negociadas junto à ASST (Amazônia Saúde e Segurança do Trabalho):</label>
                            <textarea class="ampliado" id="listaAtividades" name="listaAtividades" required></textarea><br><br>

                            <!-- Adequações em Andamento -->
                            <label for="adequacoes">Adequações em andamento (enquadramentos, mudança de endereço, abertura de unidade) especifique:</label>
                            <textarea class="ampliado" id="adequacoes" name="adequacoes" required></textarea><br><br>

                            <!-- Serviços e Produtos Permitidos -->
                            <label for="servicosProdutos">Serviços e Produtos Permitidos:</label>
                            <textarea class="ampliado" id="servicosProdutos" name="servicosProdutos" required></textarea><br><br>
                                                        
                            <!-- Data Prazo para Adequação Documental -->
                            <label for="dataPrazo">Data prazo para adequação documental:</label>
                            <select id="dataPrazo" name="dataPrazo">
                                <option value="30 Dias">30 Dias</option>
                                <option value="60 Dias">60 Dias</option>
                                <option value="90 Dias">90 Dias</option>
                            </select><br><br>

                            <!-- Número de Comunicação -->
                            <label for="numeroComunicacao">Número de Comunicação:</label>
                            <input type="text" id="numeroComunicacao" name="numeroComunicacao" required><br><br>

                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12" style="display: grid;justify-content: center;">
                            <div class="tab-container">
                                <div class="tab active" onclick="openTab(event, 'tab1')">Representante legal</div>
                                <div class="tab" onclick="openTab(event, 'tab2')">Representante legalmente aceito</div>
                            </div>
                        </div>
                    </div>
                    <div id="tab1" class="tab-content active">
                        <div class="row" style="margin-left: 20px; margin-right: 20px;">
                            <div class="col">
                                <div class="row">
                                    <div class="col-md-8">
                                        <!-- Nome -->
                                        <label for="nome">Nome do representante legal (idem sócio admnistrativo do CNPJ):</label><br>
                                        <input type="text" id="nome" name="nome" required><br><br>
                                    </div>
                                    <div class="col-md-4">
                                        <!-- CPF -->
                                        <label for="cpf">CPF:</label><br>
                                        <input type="text" id="cpf" name="cpf" required><br><br>
                                    </div>
                                </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <!-- Sexo -->
                                    <label>Sexo:</label><br>
                                    <input type="radio" id="masculino" name="sexo" value="Masculino">
                                    <label for="masculino">Masculino</label><br>
                                    <input type="radio" id="feminino" name="sexo" value="Feminino" checked>
                                    <label for="feminino">Feminino</label><br><br><br>
                                    
                                    <!-- UF Identidade -->
                                    <label for="ufIdentidade">UF Identidade:</label><br>
                                    <select id="ufIdentidade" name="ufIdentidade" required>
                                        <option value="">Selecione...</option>
                                        <option value="AC">AC</option>
                                        <option value="AL">AL</option>
                                        <option value="AP">AP</option>
                                        <option value="AM">AM</option>
                                        <option value="BA">BA</option>
                                        <option value="CE">CE</option>
                                        <option value="DF">DF</option>
                                        <option value="ES">ES</option>
                                        <option value="GO">GO</option>
                                        <option value="MA">MA</option>
                                        <option value="MT">MT</option>
                                        <option value="MS">MS</option>
                                        <option value="MG">MG</option>
                                        <option value="PA">PA</option>
                                        <option value="PB">PB</option>
                                        <option value="PR">PR</option>
                                        <option value="PE">PE</option>
                                        <option value="PI">PI</option>
                                        <option value="RJ">RJ</option>
                                        <option value="RN">RN</option>
                                        <option value="RS">RS</option>
                                        <option value="RO">RO</option>
                                        <option value="RR">RR</option>
                                        <option value="SC">SC</option>
                                        <option value="SP">SP</option>
                                        <option value="SE">SE</option>
                                        <option value="TO">TO</option>
                                    </select><br><br>
                                    
                                    <!-- Regime de Bens -->
                                    <label for="regimeBens">Regime de Bens:</label><br>
                                    <select id="regimeBens" name="regimeBens">
                                        <option value="">Selecione...</option>
                                        <option value="Comunhão de Bens">Comunhão de Bens</option>
                                        <option value="Separação de Bens">Separação de Bens</option>
                                    </select><br><br>
                                    
                                    <!-- Tipo Representante Legal -->
                                    <label for="tipoRepresentante">Tipo Representante Legal:</label><br>
                                    <select id="tipoRepresentante" name="tipoRepresentante">
                                        <option value="Gerente">Gerente</option>
                                        <option value="Tecnico Contratado">Tecnico Contratado</option>
                                        <option value="Outro">Outro</option>
        
                                    </select><br><br>
                                    
                                </div>
                                <div class="col-md-4">
                                    <!-- E-mail -->
                                    <label for="email">E-mail:</label><br>
                                    <input type="email" id="email" name="email" required><br><br>
                                    <!-- Data de Nascimento -->
                                    <label for="dataNascimento">Data de Nascimento:</label><br>
                                    <input type="date" id="dataNascimento" name="dataNascimento" required><br><br>
        
                                    <!-- Estado Civil -->
                                    <label for="estadoCivil">Estado Civil:</label><br>
                                    <select id="estadoCivil" name="estadoCivil" required>
                                        <option value="">Selecione...</option>
                                        <option value="Solteiro(a)">Solteiro(a)</option>
                                        <option value="Casado(a)">Casado(a)</option>
                                        <option value="Divorciado(a)">Divorciado(a)</option>
                                        <option value="Viúvo(a)">Viúvo(a)</option>
                                    </select><br><br>
        
                                    <!-- Profissão -->
                                    <label for="profissao">Profissão:</label><br>
                                    <input type="text" id="profissao" name="profissao"><br><br>
                                    
                                    <!-- Telefone -->
                                    <label for="telefone">Telefone:</label><br>
                                    <input type="tel" id="telefone" name="telefone" placeholder="(DDD) 0000-0000"><br><br>
                                </div>
                                <div class="col-md-4">
                                    <!-- Número de Identidade -->
                                    <label for="numIdentidade">Número de Identidade:</label><br>
                                    <input type="text" id="numIdentidade" name="numIdentidade" required><br><br>
                                    
                                    <!-- Órgão Emissor -->
                                    <label for="orgaoEmissor">Órgão Emissor:</label><br>
                                    <input type="text" id="orgaoEmissor" name="orgaoEmissor"><br><br>
                                    
                                    <!-- Data Emissão -->
                                    <label for="dataEmissao">Data Emissão:</label><br>
                                    <input type="date" id="dataEmissao" name="dataEmissao"><br><br>
        
                                    <!-- Nacionalidade -->
                                    <label for="nacionalidade">Nacionalidade:</label><br>
                                    <select id="nacionalidade" name="nacionalidade" required>
                                        <option value="">Selecione...</option>
                                        <option value="Brasileira">Brasileira</option>
                                        <option value="Estrangeira">Estrangeira</option>
                                    </select><br><br>
        
                                    <!-- Whatsapp -->
                                    <label for="whatsapp">Whatsapp:</label><br>
                                    <input type="text" id="whatsapp" name="whatsapp" placeholder="(DDD) 0000-0000"><br><br>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="tab2" class="tab-content" style="background-color: rgb(123, 255, 194);">
                        <div class="row" style="margin-left: 20px; margin-right: 20px;">
                            <div class="col">
                                <div class="row">
                                    <div class="col-md-8">
                                        <!-- Nome -->
                                        <label for="nome">Nome do representante legal (idem sócio admnistrativo do CNPJ):</label><br>
                                        <input type="text" id="nomeAceito" name="nome" required><br><br>
                                    </div>
                                    <div class="col-md-4">
                                        <!-- CPF -->
                                        <label for="cpf">CPF:</label><br>
                                        <input type="text" id="cpfAceito" name="cpf" required><br><br>
                                    </div>
                                </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <!-- Sexo -->
                                    <label>Sexo:</label><br>
                                    <input type="radio" id="masculinoAceito" name="sexoAceito" value="Masculino">
                                    <label for="masculino">Masculino</label><br>
                                    <input type="radio" id="femininoAceito" name="sexoAceito" value="Feminino" checked>
                                    <label for="feminino">Feminino</label><br><br><br>
                                    
                                    <!-- UF Identidade -->
                                    <label for="ufIdentidade">UF Identidade:</label><br>
                                    <select id="ufIdentidadeAceito" name="ufIdentidade" required>
                                        <option value="">Selecione...</option>
                                        <option value="AC">AC</option>
                                        <option value="AL">AL</option>
                                        <option value="AP">AP</option>
                                        <option value="AM">AM</option>
                                        <option value="BA">BA</option>
                                        <option value="CE">CE</option>
                                        <option value="DF">DF</option>
                                        <option value="ES">ES</option>
                                        <option value="GO">GO</option>
                                        <option value="MA">MA</option>
                                        <option value="MT">MT</option>
                                        <option value="MS">MS</option>
                                        <option value="MG">MG</option>
                                        <option value="PA">PA</option>
                                        <option value="PB">PB</option>
                                        <option value="PR">PR</option>
                                        <option value="PE">PE</option>
                                        <option value="PI">PI</option>
                                        <option value="RJ">RJ</option>
                                        <option value="RN">RN</option>
                                        <option value="RS">RS</option>
                                        <option value="RO">RO</option>
                                        <option value="RR">RR</option>
                                        <option value="SC">SC</option>
                                        <option value="SP">SP</option>
                                        <option value="SE">SE</option>
                                        <option value="TO">TO</option>
                                    </select><br><br>
                                    
                                    <!-- Regime de Bens -->
                                    <label for="regimeBens">Regime de Bens:</label><br>
                                    <select id="regimeBensAceito" name="regimeBens">
                                        <option value="">Selecione...</option>
                                        <option value="Comunhão de Bens">Comunhão de Bens</option>
                                        <option value="Separação de Bens">Separação de Bens</option>
                                    </select><br><br>
                                    
                                    <!-- Tipo Representante Legal -->
                                    <label for="tipoRepresentante">Tipo Representante Legal:</label><br>
                                    <select id="tipoRepresentanteAceito" name="tipoRepresentante">
                                        <option value="Gerente">Gerente</option>
                                        <option value="Tecnico Contratado">Tecnico Contratado</option>
                                        <option value="Outro">Outro</option>
        
                                    </select><br><br>
                                    
                                </div>
                                <div class="col-md-4">
                                    <!-- E-mail -->
                                    <label for="email">E-mail:</label><br>
                                    <input type="email" id="emailAceito" name="email" required><br><br>
                                    <!-- Data de Nascimento -->
                                    <label for="dataNascimento">Data de Nascimento:</label><br>
                                    <input type="date" id="dataNascimentoAceito" name="dataNascimento" required><br><br>
        
                                    <!-- Estado Civil -->
                                    <label for="estadoCivil">Estado Civil:</label><br>
                                    <select id="estadoCivilAceito" name="estadoCivil" required>
                                        <option value="">Selecione...</option>
                                        <option value="Solteiro(a)">Solteiro(a)</option>
                                        <option value="Casado(a)">Casado(a)</option>
                                        <option value="Divorciado(a)">Divorciado(a)</option>
                                        <option value="Viúvo(a)">Viúvo(a)</option>
                                    </select><br><br>
        
                                    <!-- Profissão -->
                                    <label for="profissao">Profissão:</label><br>
                                    <input type="text" id="profissaoAceito" name="profissao"><br><br>
                                    
                                    <!-- Telefone -->
                                    <label for="telefone">Telefone:</label><br>
                                    <input type="tel" id="telefoneAceito" name="telefone" placeholder="(DDD) 0000-0000"><br><br>
                                </div>
                                <div class="col-md-4">
                                    <!-- Número de Identidade -->
                                    <label for="numIdentidade">Número de Identidade:</label><br>
                                    <input type="text" id="numIdentidadeAceito" name="numIdentidade" required><br><br>
                                    
                                    <!-- Órgão Emissor -->
                                    <label for="orgaoEmissor">Órgão Emissor:</label><br>
                                    <input type="text" id="orgaoEmissorAceito" name="orgaoEmissor"><br><br>
                                    
                                    <!-- Data Emissão -->
                                    <label for="dataEmissao">Data Emissão:</label><br>
                                    <input type="date" id="dataEmissaoAceito" name="dataEmissao"><br><br>
        
                                    <!-- Nacionalidade -->
                                    <label for="nacionalidade">Nacionalidade:</label><br>
                                    <select id="nacionalidadeAceito" name="nacionalidade" required>
                                        <option value="">Selecione...</option>
                                        <option value="Brasileira">Brasileira</option>
                                        <option value="Estrangeira">Estrangeira</option>
                                    </select><br><br>
        
                                    <!-- Whatsapp -->
                                    <label for="whatsapp">Whatsapp:</label><br>
                                    <input type="text" id="whatsappAceito" name="whatsapp" placeholder="(DDD) 0000-0000"><br><br>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-left: 1vw; margin-right: 1vw; margin-top: 1px; max-width: 100%;">
                <div class="col-md-4">
                </div>
                <div class="col-md-4">
                    <!-- Botão de Enviar -->
                    <input type="button" style="width: 100%; height: 50px; background-color: #2f2f2fa8" onclick="coletarDados()" value="Gerar PDF" >
                </div>
                <div class="col-md-4">
                    <h5 style="color: rgb(164, 0, 0);"> (Após gerado, assinar no GOV e enviar para gestcontratos@asasesg.org )</h5>
                </div>
                <h6 style="text-align: justify; text-align-last: justify;">Este cadastramento é necessário para autorização legal dos profissionais que terão acesso às informações confidências da área de desenvolvimento dos projetos e permite a assinatura de termos de responsabilidade para os mesmos fins, dando liberdade ao mesmo de análise e deliberações quanto ao teor das contratações a seguir.</h6>
            </div>
        </div>
    </form>
    <script>
        function openTab(event, tabId) {
            // Remove a classe 'active' de todas as tabs
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            // Adiciona a classe 'active' na tab clicada e no conteúdo correspondente
            event.currentTarget.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }
        function coletarDados() {
            
            let resultado = "";
            fetch(window.location.href + "representante.txt")
                .then(response => response.text())
                .then(text => {
                    resultado = text;
                    resultado = resultado.replaceAll('{{NOME}}', document.getElementById('nome').value);
                    resultado = resultado.replaceAll('{{CPF}}', document.getElementById('cpf').value);
                    resultado = resultado.replaceAll('{{SEXO}}', document.querySelector('input[name="sexo"]:checked').value);
                    resultado = resultado.replaceAll('{{DATA_NASCIMENTO}}', document.getElementById('dataNascimento').value);
                    resultado = resultado.replaceAll('{{NUM_IDENTIDADE}}', document.getElementById('numIdentidade').value);
                    resultado = resultado.replaceAll('{{UF_IDENTIDADE}}', document.getElementById('ufIdentidade').value);
                    resultado = resultado.replaceAll('{{ORGAO_EMISSOR}}', document.getElementById('orgaoEmissor').value);
                    resultado = resultado.replaceAll('{{ESTADO_CIVIL}}', document.getElementById('estadoCivil').value);
                    resultado = resultado.replaceAll('{{REGIME_BENS}}', document.getElementById('regimeBens').value);
                    resultado = resultado.replaceAll('{{TIPO_REPRESENTANTE}}', document.getElementById('tipoRepresentante').value);
                    resultado = resultado.replaceAll('{{PROFISSAO}}', document.getElementById('profissao').value);
                    resultado = resultado.replaceAll('{{EMAIL}}', document.getElementById('email').value);
                    resultado = resultado.replaceAll('{{TELEFONE}}', document.getElementById('telefone').value);
                    resultado = resultado.replaceAll('{{NACIONALIDADE}}', document.getElementById('nacionalidade').value);
                    resultado = resultado.replaceAll('{{WPP}}', document.getElementById('whatsapp').value);
                    resultado = resultado.replaceAll('{{DATAEMISSÃO}}', document.getElementById('dataEmissao').value);
                    
                    resultado = resultado.replaceAll('{{NOMEACEITO}}', document.getElementById('nomeAceito').value);
                    resultado = resultado.replaceAll('{{CPFACEITO}}', document.getElementById('cpfAceito').value);
                    resultado = resultado.replaceAll('{{SEXOACEITO}}', document.querySelector('input[name="sexoAceito"]:checked').value);
                    resultado = resultado.replaceAll('{{DATA_NASCIMENTOACEITO}}', document.getElementById('dataNascimentoAceito').value);
                    resultado = resultado.replaceAll('{{NUM_IDENTIDADEACEITO}}', document.getElementById('numIdentidadeAceito').value);
                    resultado = resultado.replaceAll('{{UF_IDENTIDADEACEITO}}', document.getElementById('ufIdentidadeAceito').value);
                    resultado = resultado.replaceAll('{{ORGAO_EMISSORACEITO}}', document.getElementById('orgaoEmissorAceito').value);
                    resultado = resultado.replaceAll('{{ESTADO_CIVILACEITO}}', document.getElementById('estadoCivilAceito').value);
                    resultado = resultado.replaceAll('{{REGIME_BENSACEITO}}', document.getElementById('regimeBensAceito').value);
                    resultado = resultado.replaceAll('{{TIPO_REPRESENTANTEACEITO}}', document.getElementById('tipoRepresentanteAceito').value);
                    resultado = resultado.replaceAll('{{PROFISSAOACEITO}}', document.getElementById('profissaoAceito').value);
                    resultado = resultado.replaceAll('{{EMAILACEITO}}', document.getElementById('emailAceito').value);
                    resultado = resultado.replaceAll('{{TELEFONEACEITO}}', document.getElementById('telefoneAceito').value);
                    resultado = resultado.replaceAll('{{NACIONALIDADEACEITO}}', document.getElementById('nacionalidadeAceito').value);
                    resultado = resultado.replaceAll('{{WPPACEITO}}', document.getElementById('whatsappAceito').value);
                    resultado = resultado.replaceAll('{{DATAEMISSÃOACEITO}}', document.getElementById('dataEmissaoAceito').value);
                    
                    resultado = resultado.replaceAll('{{nomeEmpresa}}', document.getElementById('nomeEmpresa').value);
                    resultado = resultado.replaceAll('{{cnpj}}', document.getElementById('cnpj').value);
                    resultado = resultado.replaceAll('{{filialSede}}', document.getElementById('filialSede').value);
                    resultado = resultado.replaceAll('{{numeroComunicacao}}', document.getElementById('numeroComunicacao').value);
                    resultado = resultado.replaceAll('{{servicosProdutos}}', document.getElementById('servicosProdutos').value);
                    resultado = resultado.replaceAll('{{listaAtividades}}', document.getElementById('listaAtividades').value);
                    resultado = resultado.replaceAll('{{adequacoes}}', document.getElementById('adequacoes').value);
                    resultado = resultado.replaceAll('{{dataPrazo}}', document.getElementById('dataPrazo').value);

                    var contratoPartes = resultado.split('\r\n\r\n');
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    const fontSize = 12; // Tamanho da fonte em pontos
                    const fatorConversao = 0.3528; // 1 ponto ≈ 0.3528 mm
                    const alturaLinha = fontSize * fatorConversao;
                    var alturaTexto = 0; 
                    var linhas;
                    
                    doc.setFont("Helvetica", "normal");
                    doc.setFontSize(fontSize);
                    var aux;
                    
                    doc.addImage("./logo.png", "PNG", 10, 10, 50, 50)
                    var size = 70;

                    contratoPartes.forEach((item, index)=>{
                        doc.setFont("Helvetica", "bold");
                        aux = item;
                        linhas = doc.splitTextToSize(aux.replace('\n',''), 170);
                        doc.setFont("Helvetica", "normal");
                        alturaTexto = linhas.length * alturaLinha;
                        
                        if(size + alturaTexto >= 297){
                            doc.addPage();
                            size = 20;
                        }

                        var partition = item.split(':');
                        if(partition.length != 2){
                            doc.setFont("Helvetica", "bold");
                            doc.setFontSize(fontSize);

                            doc.text(partition[0], 20, size, { maxWidth: 170 })
                        }else{
                            doc.setFont("Helvetica", "bold");
                            doc.setFontSize(fontSize);

                            doc.text(partition[0] + ": ", 20, size, { maxWidth: 170 })

                            doc.setFont("Helvetica", "normal");
                            doc.setFontSize(fontSize);

                            doc.text("  " + partition[1], 20 + doc.getTextWidth(partition[0] + ": "), size, { maxWidth: 170 })
                        }
                        // doc.text(item, 20, size, { maxWidth: 170 });
                        if (linhas.length > 1){
                            console.log(item);
                            console.log(linhas);

                            size += alturaTexto + fatorConversao * fontSize * 2 + (linhas.length - 1) * fontSize * 0.15;
                        }else{
                            size += alturaTexto + fatorConversao * fontSize * 2;
                        }
                    })
                    doc.save("dados_representante.pdf");
            });
        }
    </script>
</body>
</html>
